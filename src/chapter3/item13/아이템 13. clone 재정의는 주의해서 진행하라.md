# ğŸ’¡ clone ì¬ì •ì˜ëŠ” ì£¼ì˜í•´ì„œ ì§„í–‰í•˜ë¼
## 1. clone()
* clone ë©”ì„œë“œëŠ” ì›ë³¸ ê°ì²´ì˜ í•„ë“œê°’ê³¼ ë™ì¼í•œ ê°’ì„ ê°€ì§€ëŠ” ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
* Objectì— ì •ì˜ë˜ì–´ ìˆëŠ” ë©”ì„œë“œ.
* CloneableëŠ” í…… ë¹„ì–´ ìˆëŠ” ì¸í„°í˜ì´ìŠ¤(ë§ˆì»¤ ì¸í„°í˜ì´ìŠ¤)ë¡œ clone ë©”ì„œë“œì˜ ë™ì‘ ë°©ì‹ì„ ê²°ì •í•œë‹¤.
## 2. clone ê·œì•½
* x.clone() != x -> true
* x.clone().getClass() == x.getClass() -> true
* x.clone().equals(x) -> true or false

## 3. êµ¬í˜„ë²• 
### [ì •ì ê°ì²´]
* í´ë˜ìŠ¤ê°€ Cloneable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ê²Œ í•˜ê³ , clone ì¬ì •ì˜ í•´ì¤˜ì•¼ í•œë‹¤.
* ë°˜í™˜íƒ€ì…ì„ ìê¸°ìì‹ ìœ¼ë¡œ ë³€ê²½í•˜ê³  clone ë©”ì„œë“œëŠ” super.cloneì„ ì‚¬ìš©í•˜ë„ë¡ ì˜¤ë²„ë¼ì´ë”© í•˜ë©° publicìœ¼ë¡œ ë³€ê²½í•œë‹¤.
```java
// ì½”ë“œ 13-1 ê°€ë³€ ìƒíƒœë¥¼ ì°¸ì¡°í•˜ì§€ ì•ŠëŠ” í´ë˜ìŠ¤ìš© clone ë©”ì„œë“œ (79ìª½)
@Override public PhoneNumber clone() {
    try {
        return (PhoneNumber) super.clone();
    } catch (CloneNotSupportedException e) {
        throw new AssertionError();  // ì¼ì–´ë‚  ìˆ˜ ì—†ëŠ” ì¼ì´ë‹¤.
    }
}
```
* Objectì˜ clone ë©”ì„œë“œëŠ” Objectë¥¼ ë°˜í™˜í•˜ì§€ë§Œ PhoneNumberì˜ clone ë©”ì„œë“œëŠ” PhoneNumberë¥¼ ë°˜í™˜í•˜ê²Œ í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì—ì„œ í˜•ë³€í™˜ì„ ì¼ì¼íˆ í•´ì£¼ì§€ ì•Šì•„ ê¶Œì¥í•˜ëŠ” ë°©ì‹ì´ë‹¤.
  * ìë°”ê°€ ê³µë³€ ë°˜í™˜ íƒ€ì´í•‘ì„ ì§€ì›í•˜ê¸° ë•Œë¬¸ -> ì¬ì •ì˜í•œ cloneì˜ ë°˜í™˜íƒ€ì…ì€ ìƒìœ„í´ë˜ìŠ¤ì˜ ë©”ì„œë“œê°€ ë°˜í™˜í•˜ëŠ” íƒ€ì…ì˜ í•˜ìœ„íƒ€ì…ì¼ ìˆ˜ ìˆë‹¤.
* clone ë©”ì„œë“œëŠ” CloneNotSupportedException ì—ëŸ¬ë¥¼ ë˜ì§€ê¸° ë•Œë¬¸ì— try-catch ê°ì‹¸ë„ë¡ í•œë‹¤.

### [ê°€ë³€ê°ì²´]
* ê°€ë³€ê°ì²´ì˜ ê²½ìš° ìœ„ ì½”ë“œë¡œëŠ” ì¶©ë¶„í•˜ì§€ ì•Šìœ¼ë©° ì›ë³¸/í´ë¡  ê°ì²´ê°€ ê°™ì€ ë°°ì—´ì„ ì°¸ì¡° í•  ìˆ˜ ìˆìœ¼ë©°, ê°ê°ì˜ ìš”ì†Œë“¤ë„ ê°™ì€ê²ƒì„ ì°¸ì¡°í•œë‹¤. (ì–•ì€ë³µì‚¬)
* ì˜ˆì œì˜ ìŠ¤íƒê°™ì€ ê²½ìš° super.cloneë§Œì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ stackê³¼ copyê°€ ê°™ì€ ë°°ì—´ì„ ì°¸ì¡° í•˜ê³  ìˆì–´ ë¶ˆë³€ì‹ì„ í•´ì¹œë‹¤.
```java
// cloneì´ ë™ì‘í•˜ëŠ” ëª¨ìŠµì„ ë³´ë ¤ë©´ ëª…ë ¹ì¤„ ì¸ìˆ˜ë¥¼ ëª‡ ê°œ ë§ë¶™ì—¬ì„œ í˜¸ì¶œí•´ì•¼ í•œë‹¤.
public static void main(String[] args) {
        Object[] values = new Object[2];
        values[0] = new PhoneNumber(123, 456, 789);
        values[1] = new PhoneNumber(321, 654, 987);

        Stack stack = new Stack();
        for (Object arg : values)
        stack.push(arg);

        Stack copy = stack.clone();

        while (!stack.isEmpty())
        System.out.println(stack.pop() + " ");

        while (!copy.isEmpty())
        System.out.println(copy.pop() + " "); 
        
        // ê²°ê³¼ê°’
        // 321-654-0987
        // 123-456-0789
        // null 
        // null 
        }

```
* ìœ„ì™€ ê°™ì€ ìƒí™©ì„ ë°©ì§€í•˜ë ¤ë©´ ë°°ì—´ë„ cloneí•˜ì—¬ ë„£ì–´ì¤€ë‹¤
```java
  // ì½”ë“œ 13-2 ê°€ë³€ ìƒíƒœë¥¼ ì°¸ì¡°í•˜ëŠ” í´ë˜ìŠ¤ìš© clone ë©”ì„œë“œ
  @Override public Stack clone() {
  try {
    Stack result = (Stack) super.clone();
    result.elements = elements.clone(); //ë°°ì—´ ë³µì‚¬
    return result;
  } catch (CloneNotSupportedException e) {
    throw new AssertionError();
  }
  }
```
* ë°°ì—´ì„ ë³µì‚¬í•´ë„£ì–´ë’€ì§€ë§Œ ì–‡ì€ ë³µì‚¬ íŠ¹ì„±ìƒ ë‹¤ë¥¸ë°°ì—´ì´ì—¬ë„ ê° ë°°ì—´ì˜ ì¸ë±ìŠ¤ëŠ” ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¸ì¡°í•œë‹¤.
```java
  System.out.println(stack.elements == copy.elements); //false
  System.out.println(stack.elements[0] == copy.elements[0]); //true
```


* ë˜ ë‹¤ë¥¸ ì˜ˆì œë¡œ í•´ì‰¬í…Œì´ë¸”ë¡œ ì¼ë°˜ì ì¸ í•´ë²•ì„ ë³´ìë©´ ê°™ì€ í¬ê¸°ì˜ ë²„í‚·ë°°ì—´ì„ í• ë‹¹ í›„, ì›ë˜ ë²„í‚· ë°°ì—´ì„ forë¬¸ìœ¼ë¡œ ê° ìš”ì†Œ í•˜ë‚˜í•˜ë‚˜ë¥¼ deepCopy()ë¥¼ ì§„í–‰í•œë‹¤.
```java
    public HashTable clone() {
        HashTable result = null;
        try {
          result = (HashTable)super.clone();
          result.buckets = new Entry[this.buckets.length]; //ìƒˆë¡œìš´ ë°°ì—´ ìƒì„±
  
          for (int i = 0 ; i < this.buckets.length; i++) {
            if (buckets[i] != null) {
                result.buckets[i] = this.buckets[i].deepCopy(); // deep copy
            }
          }
          return result;
        } catch (CloneNotSupportedException e) {
            throw  new AssertionError();
            }
    }
```
* deepCopy ë©”ì„œë“œëŠ” ìì‹ ì´ ê°€ë¦¬í‚¤ëŠ” ì—°ê²° ë¦¬ìŠ¤íŠ¸ ì „ì²´ë¥¼ ë³µì‚¬í•˜ê¸° ìœ„í•´ ìì‹ ì„ ì¬ê·€ì ìœ¼ë¡œ í˜¸ì¶œí•œë‹¤.
* ë¦¬ìŠ¤íŠ¸ì˜ ì›ì†Œ ìˆ˜ë§Œí¼ ìŠ¤íƒ í”„ë ˆì„ì„ ì†Œë¹„í•˜ì—¬, ë¦¬ìŠ¤íŠ¸ê°€ ê¸¸ë©´ ìŠ¤íƒ ì˜¤ë²„í”Œë¡œë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆë‹¤.
```java
    public Entry deepCopy() {
        return new Entry(key, value, next == null ? null : next.deepCopy());
    }
```
* ë°˜ë³µìë¥¼ ì¨ì¨ ìˆœíšŒí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.
```java
    public Entry deepCopy() {
        Entry result = new Entry(key, value, next);
        for (Entry p = result ; p.next != null ; p = p.next) {
            p.next = new Entry(p.next.key, p.next.value, p.next.next);
        }
        return result;
    }
```


### [ê°€ë³€ê°ì²´ í´ë¡  ìœ ì˜ì‚¬í•­]

* ê³ ìˆ˜ì¤€ì˜ APIë¥¼ í™œìš©í•´ ë³µì œí•˜ëŠ” ë°©ì•ˆë„ ìˆì§€ë§Œ ê¶Œê³ í•˜ì§€ ì•ŠëŠ”ë‹¤.
  * putê³¼ ê°™ì€ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ê°’ì„ ì§€ì •í•´ì¤„ ìˆ˜ ìˆìœ¼ë©° ê°„ë‹¨í•˜ê³  ì¢‹ì€ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.
  * í•˜ì§€ë§Œ ì¶”ìƒí™”ëœ apië‹¤ ë³´ë‹ˆ ì„±ëŠ¥ì  ì´ìŠˆê°€ ìˆì„ ìˆ˜ ìˆë‹¤. 
    * ê³ ìˆ˜ì¤€ APIëŠ” ë‚®ì€ ìˆ˜ì¤€ì˜ APIë¥¼ ì¶”ìƒí™”í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ í¸ì˜ë¥¼ ì œê³µí•˜ë‚˜, ë§ì€ ì¶”ìƒí™” ê³„ì¸µì´ í•„ìš”í•˜ë©°, ì´ëŠ” ì˜¤ë²„í—¤ë“œë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.]

```java
    @Override
public HashTable clone() {
        HashTable result = null;
        try {
          result = (HashTable)super.clone();
          result.buckets = new Entry[this.buckets.length];
          
          //result.put(key, value) //ê³ ìˆ˜ì¤€ APIë¥¼ í™œìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë„£ì–´ì¤Œ
          
          for (int i = 0 ; i < this.buckets.length; i++) {
            if (buckets[i] != null) {
            result.buckets[i] = this.buckets[i].deepCopy(); // p83, deep copy
            }
          }
          return result;
        } catch (CloneNotSupportedException e) {
            throw  new AssertionError();
        }
        }
```
* clone ë©”ì„œë“œ ë‚´ì—ì„œëŠ” ì¬ì •ì˜ë  ìˆ˜ ìˆëŠ” ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ì•¼ í•¨.
  * ì›ë³¸ê³¼ ë³µì œë³¸ì˜ ìƒíƒœê°€ ë‹¬ë¼ì§ˆ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ë¡œì§ì€ í˜¸ì¶œí•˜ì§€ ì•Šë„ë¡ í•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤.
```java
    @Override
public HashTable clone() {
        HashTable result = null;
        try {
          result = (HashTable)super.clone();
          result.buckets = new Entry[this.buckets.length];
          //result.buckets = CreateNewBucket();
          for (int i = 0 ; i < this.buckets.length; i++) {
            if (buckets[i] != null) {
            result.buckets[i] = this.buckets[i].deepCopy(); // p83, deep copy
            }
          }
          return result;
        } catch (CloneNotSupportedException e) {
            throw  new AssertionError();
        }
        }
```
* ì¼ë°˜ì ìœ¼ë¡œ ì¶”ìƒ í´ë˜ìŠ¤ì— Cloneable ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ê²Œ ì¢‹ë‹¤
  * ìœ„ì—ì„œ ì²˜ë¦¬í–ˆë˜ ê°œë…ë“±ì„ ìœ ì˜í•˜ë©° ì²˜ë¦¬í•´ì•¼í•˜ê¸°ë•Œë¬¸ì— ì§ì„ ì•ˆê²¨ì£¼ëŠ”ê²ƒê³¼ ê°™ë‹¤.
  * êµ¬í˜„í•  ê²½ìš° clone() ì²˜ë¦¬ ë°©ë²• 2ê°€ì§€ê°€ ìˆë‹¤.
    * ì¶”ìƒí´ë˜ìŠ¤ì—ì„œ cloneì„ ì¬ì •ì˜í•´ì£¼ê³  í•˜ìœ„í´ë˜ìŠ¤ì—ì„œ êµ³ì´ ì¬ì •ì˜ ì•ˆí•˜ë„ë¡ ì„¤ì •í•œë‹¤.
    * í•˜ìœ„í´ë˜ìŠ¤ì—ì„œ ì¬ì •ì˜ ìì²´ë¥¼ ëª»í•˜ë„ë¡ ì„¤ì •í•œë‹¤.
```java
public abstract class Shape implements Cloneable {

private int area;
public abstract int getArea();

@Override
public Object clone() throws CloneNotSupportedException {
    return super.clone();
}

//    @Override
//    protected final Object clone() throws CloneNotSupportedException {
//        throw new CloneNotSupportedException();
//    }
}
```
* ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ì•ˆì „í•¨ì„ ìœ„í•´ì„œëŠ” synchronized ë¶™ì—¬ì¤˜ì•¼ í•œë‹¤.

## 4.ê·¸ëŸ°ë° ê°ì²´ ë³µì‚¬ ì‹œ ì´ëŸ¬í•œ ê³¼ì •ì„ ê¼­ ê±°ì³ì•¼ í•˜ëŠ”ê°€?

### 1. ì´ë¯¸ Cloneableì„ êµ¬í˜„í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ë³€í™˜ ìƒì„±ì[ë³µì‚¬ ìƒì„±ì, ë³µì‚¬ íŒ©í„°ë¦¬]ë¥¼ ì‚¬ìš©í•˜ì.
### 2. ë³µì‚¬ ìƒì„±ì
* ë‹¨ìˆœíˆ ìì‹ ê³¼ ê°™ì€ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¸ìˆ˜ë¡œ ë°›ëŠ” ìƒì„±ì
```java
public PhoneNumber(PhoneNumber phoneNumber) {
    this(phoneNumber.areaCode, phoneNumber.prefix, phoneNumber.lineNum);
}
```
```java
public class PhoneNumberTest {

  public static void main(String[] args) {
    PhoneNumber phoneNumber = new PhoneNumber(123, 456, 7890);
    PhoneNumber newPhoneNumber = new PhoneNumber(phoneNumber);

    System.out.println(phoneNumber!=newPhoneNumber);
    System.out.println(phoneNumber.getClass() == newPhoneNumber.getClass());
    System.out.println(phoneNumber.equals(newPhoneNumber));
  }
  
  //true true true
}
```
### 3. ë³µì‚¬ íŒ©í„°ë¦¬
* ë³µì‚¬ ìƒì„±ìë¥¼ ëª¨ë°©í•œ ì •ì  íŒ©í„°ë¦¬
```java
public static PhoneNumber of(PhoneNumber phoneNumber) {
      return new PhoneNumber(phoneNumber.areaCode, phoneNumber.prefix, phoneNumber.lineNum);
}
```
```java
PhoneNumber newPhoneNumber2 = PhoneNumber.of(phoneNumber);
System.out.println(phoneNumber!=newPhoneNumber2);
System.out.println(phoneNumber.getClass() == newPhoneNumber2.getClass());
System.out.println(phoneNumber.equals(newPhoneNumber2));

//true true true
```

### 4. ë˜í•œ, í•´ë‹¹ í´ë˜ìŠ¤ê°€ êµ¬í˜„í•œ 'ì¸í„°í˜ì´ìŠ¤' íƒ€ì…ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¸ìˆ˜ë¡œ ë°›ì„ ìˆ˜ ìˆë‹¤.
* HashSet ê°ì²´ së¥¼ TreeSet íƒ€ì…ìœ¼ë¡œ ë³µì œí•  ìˆ˜ ìˆë‹¤.
```java
public class HashSetExample {

  public static void main(String[] args) {
    Set<String> hashSet = new HashSet<>();
    hashSet.add("keesun");
    hashSet.add("whiteship");
    System.out.println("HashSet: " + hashSet);

    Set<String> treeSet = new TreeSet<>(hashSet);

    System.out.println("TreeSet: " + treeSet);
  }
}
```