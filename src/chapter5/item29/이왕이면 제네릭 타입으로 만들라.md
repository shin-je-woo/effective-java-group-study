# π’΅ μ λ„¤λ¦­ νƒ€μ…μΌλ΅ λ³€κ²½ν•κΈ°
* μ΄λ² μ¥μ—μ„λ” μΌλ° ν΄λμ¤λ¥Ό μ λ„¤λ¦­ νƒ€μ…μΌλ΅ λ³€κ²½ν•λ” λ²•μ— λ€ν•΄ μ„¤λ…ν•κ³  μμµλ‹λ‹¤.
* MyStack μμ μ½”λ“λ¥Ό ν†µν•΄ μ λ„¤λ¦­ νƒ€μ…μΌλ΅ λ§λ“λ” λ°©λ²•μ„ μ•μ•„λ³΄κ² μµλ‹λ‹¤.

## Object κΈ°λ° μ¤νƒ
```java
public class MyStackV1 {

    private Object[] elements;
    private int size = 0;
    private static final int DEFAULT_INITIAL_CAPACITY = 16;

    public MyStackV1() {
        elements = new Object[DEFAULT_INITIAL_CAPACITY];
    }

    public void push(Object e) {
        ensureCapacity();
        elements[size++] = e;
    }

    public Object pop() {
        if (size == 0) {
            throw new EmptyStackException();
        }
        Object result = elements[--size];
        elements[size] = null;
        return result;
    }

    public boolean isEmpty() {
        return size == 0;
    }

    private void ensureCapacity() {
        if (elements.length == size) {
            elements = Arrays.copyOf(elements, 2 * size + 1);
        }
    }
}
```
* μ„ μ½”λ“μ λ¬Έμ μ μ€ λ¬΄μ—‡μΌκΉμ”?
* ν΄λΌμ΄μ–ΈνΈμ—μ„ pushν•  λ• νƒ€μ…μ— λ€ν• μ•„λ¬΄λ° μ μ•½μ΄ μ—†μµλ‹λ‹¤.
* Integer, String μ„ ν• μ¤νƒμ— push ν•  μ μμµλ‹λ‹¤.
* μ„ ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ” ν΄λΌμ΄μ–ΈνΈμ—μ„ pop λ©”μ„λ“λ¥Ό νΈμ¶ν•  κ²½μ° λ§¤λ² ν•λ³€ν™μ„ ν•΄μ•Ό ν•©λ‹λ‹¤.
* λ§μ•½, ν• μ¤νƒμ— μ—¬λ¬ νƒ€μ…μ μ›μ†κ°€ μμ„ κ²½μ° `ClassCastException` μ΄ λ°μƒν•©λ‹λ‹¤. (λ°νƒ€μ„μ— μ—λ¬κ°€ λ°μƒν•κ² λ©λ‹λ‹¤.)

```java
public static void main(String[] args) {
    MyStackV1 myStackV1 = new MyStackV1();
    myStackV1.push(1);
    myStackV1.push("1");
    String pop1 = (String) myStackV1.pop();
    String pop2 = (String) myStackV1.pop(); // ClassCastException λ°μƒ!
}
```

## μ λ„¤λ¦­ νƒ€μ…μΌλ΅ λ³€κ²½
```java
public class MyStackV2<E> {

    private E[] elements;
    private int size = 0;
    private static final int DEFAULT_INITIAL_CAPACITY = 16;
    
    public MyStackV2() {
        elements = new E[DEFAULT_INITIAL_CAPACITY];
    }

    public void push(E e) {
        ensureCapacity();
        elements[size++] = e;
    }

    public E pop() {
        if (size == 0) {
            throw new EmptyStackException();
        }
        E result = elements[--size];
        elements[size] = null;
        return result;
    }

    public boolean isEmpty() {
        return size == 0;
    }

    private void ensureCapacity() {
        if (elements.length == size) {
            elements = Arrays.copyOf(elements, 2 * size + 1);
        }
    }
}
```
* μ²« λ²μ§Έλ΅, ν΄λμ¤ μ„ μ–Έμ— νƒ€μ… λ§¤κ°λ³€μ Eλ¥Ό μ¶”κ°€ν•μ€μµλ‹λ‹¤.
* λ‘ λ²μ§Έλ΅, μ½”λ“μ— μ“°μΈ Objectλ¥Ό νƒ€μ… λ§¤κ°λ³€μλ΅ μ μ ν•κ² λ³€κ²½ν•©λ‹λ‹¤.
* μ΄ μƒνƒλ΅ μ»΄νμΌ ν•κ² λλ©΄ μ¤λ¥λ‚ κ²½κ³ κ°€ λ°μƒν•κ² λ©λ‹λ‹¤.

![image](https://github.com/shin-je-woo/effective-java-group-study/assets/39439576/560c14e4-a327-4ff7-b46c-2742e21571e0)
* μ λ„¤λ¦­μ€ μ‹¤μ²΄ν™” λ¶κ°€ νƒ€μ…μ΄λ―€λ΅ λ°°μ—΄μ„ λ§λ“¤ μ μ—†μµλ‹λ‹¤. (μ•„μ΄ν…28μ—μ„ λ°°μ΄ λ‚΄μ©)
  * μ λ„¤λ¦­μ€ νƒ€μ… μ •λ³΄κ°€ λ°νƒ€μ„μ—λ” μ†κ±°λλ‹¤.
  * μ›μ†νƒ€μ…μ„ μ¤μ§ μ»΄νμΌ μ‹μ μ—λ§ κ²€μ‚¬ν•λ‹¤.
* μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•λ” λ°©λ²•μΌλ΅λ” ν¬κ² 2κ°€μ§€κ°€ μμµλ‹λ‹¤.

## λ°°μ—΄μ„ μ λ„¤λ¦­μΌλ΅ μ°νν•λ” λ°©λ²• 1
* λ°°μ—΄μ„ μƒμ„±ν•λ” μ½”λ“μ—μ„ Objectλ°°μ—΄λ΅ λ§λ“¤κ³  μ λ„¤λ¦­ λ°°μ—΄(E)λ΅ ν•λ³€ν™ ν•©λ‹λ‹¤.
```java
public MyStackV2() {
    elements = (E[]) new Object[DEFAULT_INITIAL_CAPACITY];
}
```
* μ»΄νμΌλ¬λ” μ΄ μ½”λ“κ°€ νƒ€μ… μ•μ „ν•μ§€ ν™•μΈν•  λ°©λ²•μ΄ μ—†κΈ° λ•λ¬Έμ— `unchecked cast warning` λ¥Ό ν‘μ‹ν•©λ‹λ‹¤.
![image](https://github.com/shin-je-woo/effective-java-group-study/assets/39439576/8809fe35-bc4d-480e-bf64-2761a9c0c702)
* ν•μ§€λ§, κ°λ°μλ” μ΄ μ½”λ“κ°€ νƒ€μ… μ•μ „ν•μ§€ ν™•μΈν•μ—¬ κ²½κ³ λ¥Ό λ¬΄μ‹(@SuppressWarnings)ν•  μ μμµλ‹λ‹¤.

#### μ½”λ“κ°€ νƒ€μ… μ•μ „ν•μ§€ ν™•μΈν•κΈ°
* μ‘μ„±ν• μ¤νƒν΄λμ¤μ μ λ„¤λ¦­ λ°°μ—΄μ€ privateν•„λ“μ— μ •μλμ–΄ μμµλ‹λ‹¤. `private E[] elements`
* λν•, elementsκ°€ ν΄λΌμ΄μ–ΈνΈλ΅ λ°ν™λκ±°λ‚ λ‹¤λ¥Έ λ©”μ„λ“μ— μ „λ‹¬λλ” μΌμ΄ μ „ν€ μ—†μµλ‹λ‹¤.
* μ λ„¤λ¦­ λ°°μ—΄μ„ λ³€κ²½ν•  μ μλ” λ©”μ„λ“λ” μ¤μ§ `push` λ©”μ„λ“λ°–μ— μ—†μµλ‹λ‹¤.
* `push` λ©”μ„λ“μ—μ„λ” μ λ„¤λ¦­ λ°°μ—΄μ— μ λ„¤λ¦­ νƒ€μ…μ μ›μ†λ§ λ„£κ³  μμ–΄ elements λ°°μ—΄μ μ›μ†λ” ν•­μƒ Eμ„μ΄ λ³΄μ¥λ©λ‹λ‹¤.
* λ”°λΌμ„, λΉ„κ²€μ‚¬ ν•λ³€ν™μ€ ν•­μƒ νƒ€μ… μ•μ „ν•λ‹¤κ³  μƒκ°ν•΄λ„ λ¬΄λ°©ν•©λ‹λ‹¤.
* λ‹¤μ μ½”λ“μ²λΌ `@SuppressWarings` λ¥Ό μ‚¬μ©ν•μ—¬ λΉ„κ²€μ‚¬ κ²½κ³ λ¥Ό μ κ±°ν•©λ‹λ‹¤.
```java
@SuppressWarnings("unchecked")
public MyStackV2() {
    elements = (E[]) new Object[DEFAULT_INITIAL_CAPACITY];
}
```

## λ°°μ—΄μ„ μ λ„¤λ¦­μΌλ΅ μ°νν•λ” λ°©λ²• 2
* λ°°μ—΄ν•„λ“λ¥Ό E[]κ°€ μ•„λ‹ Object[]λ΅ μ„ μ–Έν•κ³ , Object[]μ„ ν•„μ”λ΅ ν•λ” λ©”μ„λ“μ—μ„ E[]λ΅ ν•λ³€ν™ ν•λ” λ°©λ²•μ…λ‹λ‹¤.
```java
public class MyStackV2<E> {

    private Object[] elements;
    private int size = 0;
    private static final int DEFAULT_INITIAL_CAPACITY = 16;

    public MyStackV2() {
        elements = new Object[DEFAULT_INITIAL_CAPACITY];
    }

    public void push(E e) {
        ensureCapacity();
        elements[size++] = e;
    }

    public E pop() {
        if (size == 0) {
            throw new EmptyStackException();
        }
        E result = (E) elements[--size];
        elements[size] = null;
        return result;
    }

    public boolean isEmpty() {
        return size == 0;
    }

    private void ensureCapacity() {
        if (elements.length == size) {
            elements = Arrays.copyOf(elements, 2 * size + 1);
        }
    }
}
```
* `private Object[] elements` : λ°°μ—΄μ„ μ• μ΄μ— μ λ„¤λ¦­ λ°°μ—΄μ΄ μ•„λ‹ Object[]λ΅ μ„ μ–Έν•©λ‹λ‹¤.
* μƒμ„±μμ—μ„λ” ν•λ³€ν™ μ—†μ΄ Object[]λ¥Ό μƒμ„±ν•©λ‹λ‹¤.
* `public E pop()` λ©”μ„λ“μ—μ„ elementsμ μ›μ†λ¥Ό κ°€μ Έμ¬ λ• ν•λ³€ν™ν•κ³  μμµλ‹λ‹¤.
* μ΄ ν•λ³€ν™λ„ μ»΄νμΌλ¬λ” νƒ€μ… μ•μ „ν•μ§€ ν™•μΈν•  μ μ—†κΈ° λ•λ¬Έμ— λ‹¤μκ³Ό κ°™μ€ κ²½κ³ λ¥Ό ν‘μ‹ν•©λ‹λ‹¤.
![image](https://github.com/shin-je-woo/effective-java-group-study/assets/39439576/cee7d317-50a9-4414-9edf-cbbc988b74ea)
* elementsλ” `push` λ©”μ„λ“λ¥Ό ν†µν•΄μ„λ§ λ³€κ²½λκΈ° λ•λ¬Έμ— μ΄ ν•λ³€ν™ λν• νƒ€μ… μ•μ „ν•λ‹¤κ³  νλ‹¨ν•  μ μμµλ‹λ‹¤.
* λ§μ°¬κ°€μ§€λ΅ `@SupressWarnings` λ¥Ό μ„ μ–Έν•΄ λΉ„κ²€μ‚¬ κ²½κ³ λ¥Ό μ κ±°ν•©λ‹λ‹¤.
```java
public E pop() {
    if (size == 0) {
        throw new EmptyStackException();
    }
    @SuppressWarnings("unchecked") E result = (E) elements[--size];
    elements[size] = null;
    return result;
}
```

## μ°νλ°©λ²• 1, 2μ¤‘ λ¬΄μ—‡μ„ μ‚¬μ©ν• κΉ?
* κ°μΈμ μΌλ΅ 1λ² λ°©λ²•μ΄ μ‹¤μ©μ„± μλ‹¤κ³  μƒκ°λ©λ‹λ‹¤.
* 2λ² λ°©λ²•μ€ Object[]λ¥Ό μ‚¬μ©ν•λ” λ©”μ„λ“κ°€ λμ–΄λ‚λ©΄ ν•λ³€ν™μ„ ν•΄μ•Ό ν•λ” μ½”λ“κ°€ λμ–΄λ‚©λ‹λ‹¤.
* λν•, ν•„λ“λ΅ μ„ μ–Έλ Object[]μ΄ νƒ€μ… λ§¤κ°λ³€μ Eμ™€ κ΄€λ ¨μλ” ν•„λ“μΈμ§€ ν• λμ— νμ•…μ΄ μ•λ©λ‹λ‹¤. (ν•λ³€ν™ ν•λ” μ½”λ“λ¥Ό ν™•μΈν•΄μ•Ό μ—°κ΄€μ„±μ΄ νμ•…λ©λ‹λ‹¤.)
* λ°λ©΄, 1λ²μ κ²½μ° νƒ€μ… λ§¤κ°λ³€μ Eκ°€ E[]λ΅ μ‚¬μ©λλ‹¤λ” μ μ΄ λ…ν™•ν•κ³ , μƒμ„±ν•  λ• λ”± ν•λ² ν•λ³€ν™ν•λ©΄ λκΈ° λ•λ¬Έμ— 1λ²μ΄ μ΅°κΈ λ” λ‚μ€ λ°©λ²•μΈ κ²ƒ κ°™μµλ‹λ‹¤.
