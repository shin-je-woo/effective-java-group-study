# ğŸ’¡ íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆë¥¼ ê³ ë ¤í•˜ë¼

## 1. íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆ
- ì—¬ëŸ¬ ë‹¤ë¥¸ íƒ€ì…ì˜ ê°ì²´ë¥¼ ê´€ë¦¬í•˜ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ë§í•œë‹¤. 
- ì œë„¤ë¦­ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ì–‘í•œ íƒ€ì…ì˜ ê°ì²´ë¥¼ ì•ˆì „í•˜ê²Œ ì €ì¥í•˜ê³  ê²€ìƒ‰í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•œë‹¤.

## 2. íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆ íŒ¨í„´ êµ¬í˜„
* Class í´ë˜ìŠ¤ë¥¼ í‚¤ ê°’ìœ¼ë¡œ, ê°’ì€ objectë¡œ ì²˜ë¦¬í•œë‹¤.
```java
private Map<Class<?>, Object> favorites = new HashMap<>();
```
* ì½”ë“œ ì˜ˆì‹œ
```java
public class Favorites {
    // ì½”ë“œ 33-3 íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆ íŒ¨í„´ - êµ¬í˜„ (200ìª½)
    private Map<Class<?>, Object> favorites = new HashMap<>();

    public <T> void putFavorite(Class<T> type, T instance) {
        favorites.put(Objects.requireNonNull(type), instance);
    }

    public <T> T getFavorite(Class<T> type) {
        return type.cast(favorites.get(type));
    }

    // ì½”ë“œ 33-2 íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆ íŒ¨í„´ - í´ë¼ì´ì–¸íŠ¸ (199ìª½)
    public static void main(String[] args) {
        Favorites favorites = new Favorites();

        favorites.putFavorite(String.class, "Java");
        favorites.putFavorite(Integer.class, 0xcafebabe);

        String favoriteString = favorites.getFavorite(String.class);
        int favoriteInteger = favorites.getFavorite(Integer.class);

    }
}
```

* Classì˜ castë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 
```java
    public <T> T getFavorite(Class<T> type) {
        return type.cast(favorites.get(type));
        //return (T) favorites.get(type);
    }
```

* ë°˜í™˜ íƒ€ì…ì´ ì œë„¤ë¦­ì´ê¸° ë•Œë¬¸ì— ì´ì¢… ì»¨í…Œì´ë„ˆ íŒ¨í„´ì— ì í•© 
```java
    public T cast(Object obj) {
        if (obj != null && !isInstance(obj))
        throw new ClassCastException(cannotCastMsg(obj));
        return (T) obj;
        }
```

## 3. ì œì•½ ì‚¬í•­
### 1) keyê°’ì˜ Class ê°ì²´ë¥¼ ë¡œ íƒ€ì…ìœ¼ë¡œ ë„˜ê¸°ë©´ ì•ˆì •ì„±ì´ ê¹¨ì§
```java
    public static void main(String[] args) {
        Favorites favorites = new Favorites();
        
        favorites.putFavorite(String.class, "Java");
        favorites.putFavorite(String.class, 1); //ì—ëŸ¬
        favorites.putFavorite((Class)String.class, 1); //ì—ëŸ¬ë‚˜ì§€ ì•ŠìŒ
        }
```

* ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ put : typeCast ì‚¬ìš©
```java
    public <T> void putFavorite(Class<T> type, T instance) {
        favorites.put(Objects.requireNonNull(type), type.cast(instance));
        }
```

### 2) ì‹¤ì²´í™” ë¶ˆê°€ íƒ€ì…ì€ ë¶ˆê°€ëŠ¥í•˜ë‹¤.
```java
    public static void main(String[] args) {
        Favorites favorites = new Favorites();
        
        //List<String>.class, List<Integer>.classëŠ” ê°™ì€ List í´ë˜ìŠ¤ë¥¼ ê³µìœ í•´ì„œ ì‚¬ìš©ë¶ˆê°€.
        favorites.putFavorite(List<String>.class, "Java"); //ì—ëŸ¬
    }
```


## 4. íƒ€ì…í† í°ì„ ì œí•œí•˜ê³  ì‹¶ë‹¤ë©´?
* ì˜ˆì œì˜ Favoritesê°€ ì‚¬ìš©í•˜ëŠ” íƒ€ì…í† í°ì€ ë¹„í•œì •ì ìœ¼ë¡œ ëª¨ë“  classê°€ íƒ€ì…ì´ ë  ìˆ˜ ìˆë‹¤.
### 1) í•œì •ì  íƒ€ì… í† í° ì‚¬ìš©
* AnnotatedElementì˜ getAnnotationë©”ì„œë“œ
```java
        //í•œì •ì  íƒ€ì… í† í°
public <T extends Annotation> 
    T getAnnotation<Class<T> annotationType);
```

```java
public class Favorites_Bounded {
    private Map<Class<?>, Object> favorites = new HashMap<>();

    //Number í•˜ìœ„ í´ë˜ìŠ¤ë§Œ í¬í•¨í•˜ë„ë¡
    public <T extends Number> void putFavorite(Class<T> type, T instance) {
        favorites.put(Objects.requireNonNull(type), instance);
    }

    public <T extends Number> T getFavorite(Class<T> type) {
        return type.cast(favorites.get(type));
    }

    public static void main(String[] args) {
        Favorites_Bounded favorites = new Favorites_Bounded();

        favorites.putFavorite(String.class, "A"); //ì»´íŒŒì¼ ì—ëŸ¬
        favorites.putFavorite(Integer.class, 1);
        favorites.putFavorite(Double.class, 2.1);

        int favoriteInteger = favorites.getFavorite(Integer.class);
        Double favoriteDouble = favorites.getFavorite(Double.class);

        System.out.println("Favorite Integer: " + favoriteInteger);
        System.out.println("favorite Double = " + favoriteDouble);
    }
}
```

### 2) Class<T> íƒ€ì…ì˜ ê°ì²´ë¥¼ í•œì •ì  íƒ€ì… í† í°ì„ ë°›ëŠ” ë©”ì„œë“œì— ë„˜ê¸°ë ¤ë©´?

```java
public class PrintAnnotation {
    static Annotation getAnnotation(AnnotatedElement element,String annotationTypeName) {
        Class<?> annotationType = null; // ë¹„í•œì •ì  íƒ€ì… í† í°
        try {
            annotationType = Class.forName(annotationTypeName);
        } catch (Exception ex) {
            throw new IllegalArgumentException(ex);
        }
        return element.getAnnotation(
                annotationType.asSubclass(Annotation.class));
    }

    // ëª…ì‹œí•œ í´ë˜ìŠ¤ì˜ ëª…ì‹œí•œ ì• ë„ˆí…Œì´ì…˜ì„ ì¶œë ¥í•˜ëŠ” í…ŒìŠ¤íŠ¸ í”„ë¡œê·¸ë¨
    public static void main(String[] args) throws Exception {
        String name = TestClass.class.getName();
        Class<?> klass = Class.forName(name);
        System.out.println(getAnnotation(klass, TestAnnotation.class.getName()));
    }
}
```